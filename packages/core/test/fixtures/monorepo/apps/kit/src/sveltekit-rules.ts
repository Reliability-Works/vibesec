export const sveltekitRulesFixture = {
  note: 'This file is a fixture used by VibeSec tests.',
}

export const sveltekitSecurityFixtures = [
  "throw redirect(302, url.searchParams.get('next'))",
  "redirect(301, url.searchParams.get('next'))",
  "redirect(302, url.searchParams.get('next'))",
  "cookies.set('session', token)",
  "cookies.set('session', token, { secure: false, httpOnly: false, sameSite: 'none', domain: '.example.com', path: '/' })",
  "Content-Security-Policy', \"script-src 'self' 'unsafe-inline'\"",
  "Content-Security-Policy', \"script-src 'self' 'unsafe-eval'\"",
  'X-Powered-By',
  "'http://example.com'",
  "process.env['NODE_TLS_REJECT_UNAUTHORIZED'] = '0'",
  'rejectUnauthorized: false',
  'http://localhost',
  '169.254.169.254',
  "fetch(url.searchParams.get('url'))",
  'path.join(userInput)',
  "readFile(url.searchParams.get('path'))",
  "writeFile(url.searchParams.get('path'))",
  'eval(userInput)',
  "new Function('return 1')()",
  "exec('id')",
  "execSync('id')",
  "spawn('sh', ['-c', 'id'])",
  "spawnSync('sh', ['-c', 'id'])",
  "fork('worker.js')",
  "createHash('md5')",
  "createHash('sha1')",
  'Math.random()',
  "cookieParser('super-secret-cookie-parser')",
  "SESSION_SECRET = 'hardcoded-session-secret'",
  "jwt.sign(payload, 'super-secret-jwt')",
  "algorithms: ['none']",
  'bcrypt.hash(password, 10)',
  'password === input',
  'SELECT * FROM users + req.query.id',
  '$where',
  "new RegExp(url.searchParams.get('q'))",
  '{@html content}',
  'text/html',
  "Access-Control-Allow-Origin', '*'",
  "Access-Control-Allow-Headers', '*'",
  "Access-Control-Allow-Methods', '*'",
  'credentials: true',
  'debug: true',
  'console.log(process.env.SECRET)',
  "authorization console.log('leak')",
  'console.log(await request.json())',
  'console.log(request.headers)',
  'JSON.parse(await request.text())',
  'xml2js',
  'graphql-playground',
  'rateLimit()',
  'csrf: false',
  'upload.any()',
  '"/tmp/uploads"',
  "{ headers: { Location: url.searchParams.get('next') } }",
].join('\n')

export const sveltekitTemplateInterpolationFixture = "${url.searchParams.get('q')}"

export const sveltekitSqlTemplateInterpolationFixture =
  'SELECT * FROM users WHERE id = ${userInput}'
